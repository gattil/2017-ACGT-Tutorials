<!DOCTYPE html>
<html>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Exercise 2 - Branch models</title>
    <meta name="description" content="We will use codeml program from PAML by Ziheng Yang. Use the command line mode for the tasks below. First, you need to understand which control file options ...">


    <link rel="stylesheet" href="/2017-ACGT-Tutorials/css/main.css">
    <link rel="stylesheet" href="/2017-ACGT-Tutorials/css/font-awesome.min.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic,500" type="text/css">


    <link rel="shortcut icon" href="/2017-ACGT-Tutorials/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.2.3 -->
<title>Exercise 2 - Branch models | ACGT Tutorials</title>
<meta property="og:title" content="Exercise 2 - Branch models" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We will use codeml program from PAML by Ziheng Yang. Use the command line mode for the tasks below. First, you need to understand which control file options to use. Next, try to reproduce the same analyses with codeml. You will need a dataset of homologous protein-coding DNA sequences (starting with the 1st codon position and ending with the 3rd). We will use data from published articles and will regenerate published results:" />
<meta property="og:description" content="We will use codeml program from PAML by Ziheng Yang. Use the command line mode for the tasks below. First, you need to understand which control file options to use. Next, try to reproduce the same analyses with codeml. You will need a dataset of homologous protein-coding DNA sequences (starting with the 1st codon position and ending with the 3rd). We will use data from published articles and will regenerate published results:" />
<link rel="canonical" href="http://lorenzogatti.me/2017-ACGT-Tutorials/docs/exercises_paml_1/" />
<meta property="og:url" content="http://lorenzogatti.me/2017-ACGT-Tutorials/docs/exercises_paml_1/" />
<meta property="og:site_name" content="ACGT Tutorials" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-06-15T09:01:16+02:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Exercise 2 - Branch models","datePublished":"2017-06-15T09:01:16+02:00","dateModified":"2017-06-15T09:01:16+02:00","description":"We will use codeml program from PAML by Ziheng Yang. Use the command line mode for the tasks below. First, you need to understand which control file options to use. Next, try to reproduce the same analyses with codeml. You will need a dataset of homologous protein-coding DNA sequences (starting with the 1st codon position and ending with the 3rd). We will use data from published articles and will regenerate published results:","url":"http://lorenzogatti.me/2017-ACGT-Tutorials/docs/exercises_paml_1/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="http://lorenzogatti.me/2017-ACGT-Tutorials/docs/exercises_paml_1/">
    <link rel="alternate" type="application/rss+xml" title="ACGT Tutorials" href="http://lorenzogatti.me/2017-ACGT-Tutorials/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
            <a class="navbar-brand" href="/2017-ACGT-Tutorials/">
                <!--<span><img src="/2017-ACGT-Tutorials/img/logonav.png" style="margin-top: -14px; width:40px;"></span>--> ACGT Tutorials
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <!--
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/exercises/">Exercises</a></li>
                <li ><a href="/2017-ACGT-Tutorials">Blog</a></li>
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/solutions/">Solutions</a></li>
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/HPC/">HPC</a></li>
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/home/about/">About</a></li>-->
            </ul>
            <div class="navbar-right">
                <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                        <input id="search-box" type="text" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form>
                <ul class="nav navbar-nav">
                    <li><a href="https://github.com/gattil/2017-ACGT-Tutorials"><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>


    <div class="page-content">
        <div class="wrapper">
            <div class="container">
    <div class="row">
        <div class="col-md-4">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
          Getting Started
        </a>
      </h4>
    </div>
    <div id="collapse-1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/howto_Format_Data/">Data formats in bioinformatics</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/howto_Visualize_Data/">How to visualise phylogenetic trees and alignments</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/howto_PhyML/">How to use PhyML</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
          Day 1 - Phylogenetic tree reconstruction
        </a>
      </h4>
    </div>
    <div id="collapse-2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/slides_day_1/">Slides day 1</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_0/">Exercise 1 - Parameter estimation</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_1/">Exercise 2 - Tree topologies</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_2/">Exercise 3 - Model comparison</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_3/">Exercise 4 - Branch support</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_4/">Exercise 5 - Command line</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_5/">Exercise 6 - Inferring ML phylogenies with codon models</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_6/">Exercise 7 - Inferring ML phylogenies using real datasets</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_7/">Exercise 8 - Re-Analyze published datasets</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-3" aria-expanded="false" aria-controls="collapse-3">
          Day 2 - Detecting positive selection
        </a>
      </h4>
    </div>
    <div id="collapse-3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/slides_day_2/">Slides day 2</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_paml_0/">Exercise 1 - Simple codon model</a>
        
          
          
          <a class="list-group-item active" href="/2017-ACGT-Tutorials/docs/exercises_paml_1/">Exercise 2 - Branch models</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_paml_2/">Exercise 3 - Site models</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-4" aria-expanded="false" aria-controls="collapse-4">
          Day 3.1 - Detecting episodic selection
        </a>
      </h4>
    </div>
    <div id="collapse-4" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_paml_3/">Exercise 7</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-5" aria-expanded="false" aria-controls="collapse-5">
          Day 3.2 - Pipelines exercises
        </a>
      </h4>
    </div>
    <div id="collapse-5" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/pipelines_1/">Pipelines</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-6" aria-expanded="false" aria-controls="collapse-6">
          Solutions
        </a>
      </h4>
    </div>
    <div id="collapse-6" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/solutions_phyml_0/">Solution 1 - Parameter estimation</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/solutions_phyml_1/">Solution 2 - Tree topologies</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/solutions_phyml_2/">Solution 3 - Model comparison</a>
        
      </ul>
    </div>
  </div>

</div>

        </div>

        <div class="col-md-8">
            <h1>Exercise 2 - Branch models</h1>
            <div id="markdown-content-container"><p>We will use codeml program from PAML by Ziheng Yang. Use the command line mode for the tasks below. First, you need to understand which control file options to use. Next, try to reproduce the same analyses with <code>codeml</code>.</p>
<p>You will need a dataset of homologous protein-coding DNA sequences (starting with the 1<sup>st</sup> codon position and ending with the 3<sup>rd</sup>). We will use data from published articles and will regenerate published results: </p>

<ul>
<li><p>Branch models: Yang, Z. 1998. Likelihood ratio tests for detecting positive selection and application to primate lysozyme evolution. Mol. Biol. Evol. 15:568-573.  <br />
Data 1: <a href="../../tutorial_data/tutorial02_paml/lysozymeSmall.nuc">lysozymeSmall.nuc</a>Tree 1: <a href="../../tutorial_data/tutorial02_paml/lysozymeSmall.trees">lysozymeSmall.trees</a> </p></li>
</ul>

<hr />

<p><strong>Branch models</strong>.</p>

<ol>
  <li>
    <p>Use the small lysozyme example to fit <strong>free-ratio model</strong> for branches.
Are results consistent with those presented in the publication above?</p>
  </li>
  <li>
    <p>Label the branch leading to colobine clade and fit the <strong>2-ratio branch model</strong> to your data.</p>
  </li>
  <li>
    <p>In addition, <strong>label the branch</strong> leading to hominoids clade (use different label) and fit the <strong>3-ratio branch model</strong> to your data.</p>
  </li>
  <li>
    <p>Based on LRTs, what model fits your data the best (among 2-ratio, 3-ratio and free-ratio models)?
What are the degrees of freedoms for each comparison?</p>
  </li>
  <li>
    <p>What can you tell about the evolution of your gene from the ML estimates under this best model?&lt;/p&gt;&lt;/li&gt;</p>
  </li>
</ol>

<hr />

<p>Please refer to <code>PaML/codeml</code> documentation available <a href="http://abacus.gene.ucl.ac.uk/software/pamlDOC.pdf">here</a></p>
</div>
            <!--<p class="text-center">
              <br />
              <a target="_blank" href="/_docs/pages/exercises_paml_1.md" class="btn btn-default githubEditButton" role="button">
                <i class="fa fa-pencil fa-lg"></i> Improve this page
              </a>
          </p>-->
            <hr>
            





  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/2017-ACGT-Tutorials/docs/exercises_paml_0/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        
        
        <li class="next">
          <a href="/2017-ACGT-Tutorials/docs/exercises_paml_2/">
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
    </div>
    <div class="clear"></div>
    

        </div>

    </div>
</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center" style="font-size:12px">
            Copyright © 2017  Applied Computationa Genomics Team &mdash; Lorenzo Gatti (<a href="https://github.com/gattil">@gattil</a>) &amp; Maria Anisimova |
            Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll</a>
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = '/2017-ACGT-Tutorials'
</script>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="/2017-ACGT-Tutorials/js/bootstrap.min.js "></script>
<script src="/2017-ACGT-Tutorials/js/typeahead.bundle.min.js "></script>

<script src="/2017-ACGT-Tutorials/js/main.js "></script>

</body>

</html>
