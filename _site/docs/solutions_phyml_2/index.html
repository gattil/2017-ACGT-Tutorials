<!DOCTYPE html>
<html>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Solution 3 - Model comparison</title>
    <meta name="description" content="Inferring phylogenies using maximum likelihoodObserving the effect of substitution models the final inferred tree topology.">


    <link rel="stylesheet" href="/2017-ACGT-Tutorials/css/main.css">
    <link rel="stylesheet" href="/2017-ACGT-Tutorials/css/font-awesome.min.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic,500" type="text/css">


    <link rel="shortcut icon" href="/2017-ACGT-Tutorials/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.2.3 -->
<title>Solution 3 - Model comparison | ACGT Tutorials</title>
<meta property="og:title" content="Solution 3 - Model comparison" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Inferring phylogenies using maximum likelihood Observing the effect of substitution models the final inferred tree topology." />
<meta property="og:description" content="Inferring phylogenies using maximum likelihood Observing the effect of substitution models the final inferred tree topology." />
<link rel="canonical" href="http://lorenzogatti.me/2017-ACGT-Tutorials/docs/solutions_phyml_2/" />
<meta property="og:url" content="http://lorenzogatti.me/2017-ACGT-Tutorials/docs/solutions_phyml_2/" />
<meta property="og:site_name" content="ACGT Tutorials" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-06-13T00:56:34+02:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Solution 3 - Model comparison","datePublished":"2017-06-13T00:56:34+02:00","dateModified":"2017-06-13T00:56:34+02:00","description":"Inferring phylogenies using maximum likelihood Observing the effect of substitution models the final inferred tree topology.","url":"http://lorenzogatti.me/2017-ACGT-Tutorials/docs/solutions_phyml_2/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="http://lorenzogatti.me/2017-ACGT-Tutorials/docs/solutions_phyml_2/">
    <link rel="alternate" type="application/rss+xml" title="ACGT Tutorials" href="http://lorenzogatti.me/2017-ACGT-Tutorials/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
            <a class="navbar-brand" href="/2017-ACGT-Tutorials/">
                <!--<span><img src="/2017-ACGT-Tutorials/img/logonav.png" style="margin-top: -14px; width:40px;"></span>--> ACGT Tutorials
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <!--
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/exercises/">Exercises</a></li>
                <li ><a href="/2017-ACGT-Tutorials">Blog</a></li>
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/solutions/">Solutions</a></li>
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/HPC/">HPC</a></li>
                <li  class="active" ><a href="/2017-ACGT-Tutorials/docs/home/about/">About</a></li>-->
            </ul>
            <div class="navbar-right">
                <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                        <input id="search-box" type="text" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form>
                <ul class="nav navbar-nav">
                    <li><a href="https://github.com/gattil/2017-ACGT-Tutorials"><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>


    <div class="page-content">
        <div class="wrapper">
            <div class="container">
    <div class="row">
        <div class="col-md-4">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
          Getting Started
        </a>
      </h4>
    </div>
    <div id="collapse-1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/howto_Format_Data/">Data formats in bioinformatics</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/howto_Visualize_Data/">How to visualise phylogenetic trees and alignments</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/howto_PhyML/">How to use PhyML</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
          Day 1 - Phylogenetic tree reconstruction
        </a>
      </h4>
    </div>
    <div id="collapse-2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_0/">Exercise 1 - Parameter estimation</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_1/">Exercise 2 - Tree topologies</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_2/">Exercise 3 - Model comparison</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_3/">Exercise 4 - Branch support</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_4/">Exercise 5 - Command line</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_5/">Exercise 6 - Inferring ML phylogenies with codon models</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_6/">Exercise 7 - Inferring ML phylogenies using real datasets</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/exercises_phyml_7/">Exercise 8 - Re-Analyze published datasets</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-3" aria-expanded="false" aria-controls="collapse-3">
          Day 2 - Detecting positive selection
        </a>
      </h4>
    </div>
    <div id="collapse-3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-4" aria-expanded="false" aria-controls="collapse-4">
          Day 3.1 - Detecting episodic selection
        </a>
      </h4>
    </div>
    <div id="collapse-4" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-5" aria-expanded="false" aria-controls="collapse-5">
          Day 3.2 - Pipelines exercises
        </a>
      </h4>
    </div>
    <div id="collapse-5" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-6" aria-expanded="false" aria-controls="collapse-6">
          Solutions
        </a>
      </h4>
    </div>
    <div id="collapse-6" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/solutions_phyml_0/">Solution 1 - Parameter estimation</a>
        
          
          
          <a class="list-group-item " href="/2017-ACGT-Tutorials/docs/solutions_phyml_1/">Solution 2 - Tree topologies</a>
        
          
          
          <a class="list-group-item active" href="/2017-ACGT-Tutorials/docs/solutions_phyml_2/">Solution 3 - Model comparison</a>
        
      </ul>
    </div>
  </div>

</div>

        </div>

        <div class="col-md-8">
            <h1>Solution 3 - Model comparison</h1>
            <div id="markdown-content-container"><h5 id="inferring-phylogenies-using-maximum-likelihood">Inferring phylogenies using maximum likelihood</h5>
<h6 id="observing-the-effect-of-substitution-models-the-final-inferred-tree-topology"><strong>Observing the effect of substitution models the final inferred tree topology.</strong></h6>

<p><br /></p>

<h4 id="goals">Goals</h4>

<p>In this exercise you are asked to compare different substitution models (and their variations) on the same dataset.</p>

<hr />

<div class="panel panel-primary">
    <div class="panel-heading">Datasets</div>
    <div class="panel-body">
        Dataset file: <div class="btn-group">
          <a href="#" class="btn btn-default">primates-nt.phy</a>
          <a href="#" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">View</a></li>
            <li><a href="#">Download</a></li>
          </ul>
        </div>
    </div>
</div>

<hr />

<h5 id="execution-2">Execution</h5>

<table>
<thead>
<tr>
  <th>Model</th>
  <th>Log-likelihood</th>
  <th>Parameters</th>
  <th>AIC</th>
</tr>
</thead>
<tbody><tr>
  <td>JC</td>
  <td>-6379.66383</td>
  <td>38</td>
  <td>12835.32766</td>
</tr>
<tr>
  <td>JC_I</td>
  <td>-6311.41650</td>
  <td>39</td>
  <td>12700.833</td>
</tr>
<tr>
  <td>JC_G</td>
  <td>-6304.38084</td>
  <td>39</td>
  <td>12686.76168</td>
</tr>
<tr>
  <td>JC_G_I</td>
  <td>-6304.35263</td>
  <td>40</td>
  <td>12688.70526</td>
</tr>
<tr>
  <td>HKY</td>
  <td>-6251.43051</td>
  <td>42</td>
  <td>12586.86102</td>
</tr>
<tr>
  <td>HKY_I</td>
  <td>-6180.09689</td>
  <td>43</td>
  <td>12446.19378</td>
</tr>
<tr>
  <td>HKY_G</td>
  <td>-6172.58045</td>
  <td>43</td>
  <td>12431.1609</td>
</tr>
<tr>
  <td>HKY_G_I</td>
  <td>-6172.52896</td>
  <td>44</td>
  <td>12433.05792</td>
</tr>
<tr>
  <td>GTR</td>
  <td>-6241.48788</td>
  <td>46</td>
  <td>12574.97576</td>
</tr>
<tr>
  <td>GTR_I</td>
  <td>-6171.17472</td>
  <td>47</td>
  <td>12436.34944</td>
</tr>
<tr>
  <td>GTR_G</td>
  <td>-6163.87291</td>
  <td>47</td>
  <td>12421.74582</td>
</tr>
<tr>
  <td>GTR_G_I</td>
  <td>-6172.52896</td>
  <td>48</td>
  <td>12441.05792</td>
</tr>
</tbody></table>

<p>The number of parameters are computed in the following way for a rooted <br />
tree:</p>

<blockquote>
  <p><script type="math/tex" id="MathJax-Element-11">k = (2 \ast \text{no. taxa} - 2) + \text{no. parameters in substitution model} + \text{extra parameters}</script></p>

  <p>substitution models: JC = 0 parameters | HKY = 4 parameters | GTR = 8 <br />
  parameters <br />
  invariant sites = +1 parameter <br />
  gamma rates = +1 parameter</p>
</blockquote>

<p>We compute the AIC value as follows:</p>

<blockquote>
  <p><script type="math/tex" id="MathJax-Element-12">AIC = 2(k) - \log(L)</script></p>
</blockquote>

<hr />

<h5 id="questions-2">Questions</h5>

<p><strong>1. Which model is the best (including HKY+Gamma), based on the AIC criterion?</strong></p>

<p>We select the model with the lowest AIC value. In this case, <strong>GTR + Gamma</strong></p>

<hr />

<p>This exercise can also be solved using <a href="https://github.com/ddarriba/jmodeltest2">jmodeltest</a> which performs automatically phylogenetic tree reconstructions with every model and extra parameters (i.e. invariant sites, gamma).</p>

<hr />

<div class="panel panel-default">
    <div class="panel-heading">Tasks</div>
    <div class="panel-body">
    <ol>
      <li>Which model is the best (including HKY+Gamma), based on the AIC criterion?</li>
      <li>What about adding invariant sites (+I)?</li>
    </ol>
    </div>
</div>
</div>
            <!--<p class="text-center">
              <br />
              <a target="_blank" href="/_docs/pages/solutions_phyml_2.md" class="btn btn-default githubEditButton" role="button">
                <i class="fa fa-pencil fa-lg"></i> Improve this page
              </a>
          </p>-->
            <hr>
            





  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/2017-ACGT-Tutorials/docs/solutions_phyml_1/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        <li class="next disabled">
          <a>
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
    </div>
    <div class="clear"></div>
    

        </div>

    </div>
</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center" style="font-size:12px">
            Copyright © 2017  Applied Computationa Genomics Team &mdash; Lorenzo Gatti (<a href="https://github.com/gattil">@gattil</a>) &amp; Maria Anisimova |
            Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll</a>
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = '/2017-ACGT-Tutorials'
</script>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="/2017-ACGT-Tutorials/js/bootstrap.min.js "></script>
<script src="/2017-ACGT-Tutorials/js/typeahead.bundle.min.js "></script>

<script src="/2017-ACGT-Tutorials/js/main.js "></script>

</body>

</html>
